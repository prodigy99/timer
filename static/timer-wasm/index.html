<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width,initial-scale=1" />

		<title>COI</title>
		<!-- 开启COOP&COEP 以使用SharedArrayBuffer -->
		<script src="./coi-serviceworker.js"></script>
	</head>

	<body>
		<script>
			Module = {};
			Module.onRuntimeInitialized = function () {
				let t0 = performance.now();
				let ptr = Module._createThread();
				setTimeout(() => {
					let elapsed = performance.now() - t0;
					let count = Module.HEAP32[ptr >> 2]; // 读取内存

					document.write("Elapsed Time: " + elapsed + "<br>");
					document.write("Counter: " + count + "<br>");
					let precision = elapsed / count;
					document.write("Precision: " + precision + " ms<br>");
				}, 1000);
			};
		</script>

		<script src="./thread.js"></script>
	</body>
</html>
